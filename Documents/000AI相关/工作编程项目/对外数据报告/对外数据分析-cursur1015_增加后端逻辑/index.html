<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI平台品牌数据分析报告 V3.1</title>
    
    <!-- 外部依赖 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- 本地样式 -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- 页面头部 -->
        <header>
            <div class="version-badge">V3.1</div>
            <h1>AI平台品牌数据分析报告</h1>
            <p class="subtitle">
                品牌在AI平台的表现分析与关键词洞察
                <span class="data-status mock" id="dataStatus">演示数据</span>
            </p>
        </header>

        <!-- 数据上传区域 -->
        <div class="upload-section">
            <h2 class="upload-title">📊 数据上传</h2>
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">📁</div>
                <div class="upload-text">点击或拖拽文件到此处上传</div>
                <div class="upload-hint">支持 Excel (.xlsx, .xls) 和 CSV 格式，支持多Sheet表格</div>
            </div>
            <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" />
            <div class="file-info" id="fileInfo">
                <div class="file-name" id="fileName"></div>
            </div>
            <div class="upload-actions">
                <button class="btn btn-primary" id="analyzeBtn" disabled>开始分析</button>
                <button class="btn btn-secondary" onclick="copyReportLink()">
                    📋 复制报告链接
                </button>
            </div>
        </div>

        <!-- 数据封面 -->
        <div class="data-cover" id="dataCover">
            <h2 class="data-cover-title">📈 数据概览</h2>
            <div class="data-cover-grid" id="dataCoverGrid"></div>
        </div>

        <!-- Tab导航 -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('brand')">品牌核心指标</button>
            <button class="tab" onclick="switchTab('keyword')">关键词分析</button>
        </div>

        <!-- Tab 1: 品牌核心指标 -->
        <div id="brand-section" class="content-section active">
            <!-- 品牌Tab的筛选器 -->
            <div class="filter-section">
                <div class="filter-item">
                    <label for="brandAiPlatform">AI平台</label>
                    <select id="brandAiPlatform" onchange="onBrandPlatformChange()">
                        <option value="all">所有AI平台</option>
                    </select>
                </div>
            </div>
            <!-- 品牌排名矩阵表 -->
            <div class="card">
                <h2 class="card-title">📊 品牌排名矩阵表</h2>
                <div style="overflow-x: auto;">
                    <table id="brandRankingTable">
                        <thead>
                            <tr>
                                <th>分析维度</th>
                                <th>排名1</th>
                                <th>排名2</th>
                                <th>排名3</th>
                                <th>排名4</th>
                                <th>排名5</th>
                            </tr>
                        </thead>
                        <tbody id="brandRankingBody">
                            <tr><td colspan="6">加载中...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 品牌对比图 -->
            <div class="card">
                <h2 class="card-title">📈 品牌对比图</h2>
                <div class="metric-selector">
                    <label for="chartMetric">选择指标：</label>
                    <select id="chartMetric">
                        <option value="visibility">可见概率</option>
                        <option value="recommendation">推荐概率</option>
                        <option value="top1">Top1占比</option>
                        <option value="top3">Top3占比</option>
                        <option value="top5">Top5占比</option>
                        <option value="top10">Top10占比</option>
                        <option value="sourcePlatform">信源平台占比</option>
                        <option value="sourceArticle">信源文章占比</option>
                        <option value="positive">正向情感占比</option>
                        <option value="negative">负向情感占比</option>
                        <option value="top1Keywords">Top1关键词数</option>
                        <option value="top3Keywords">Top3关键词数</option>
                        <option value="top5Keywords">Top5关键词数</option>
                        <option value="top10Keywords">Top10关键词数</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="brandChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tab 2: 关键词分析 -->
        <div id="keyword-section" class="content-section">
            <!-- 关键词Tab的筛选器 -->
            <div class="filter-section">
                <div class="filter-item">
                    <label for="keywordAiPlatform">AI平台</label>
                    <select id="keywordAiPlatform" onchange="onKeywordPlatformChange()">
                        <option value="">请选择AI平台</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="dimensionSelect">分析维度</label>
                    <select id="dimensionSelect" onchange="onDimensionChange()">
                        <option value="visibility">可见概率</option>
                        <option value="recommendation">推荐概率</option>
                        <option value="top1">Top1占比</option>
                        <option value="top3">Top3占比</option>
                        <option value="top5">Top5占比</option>
                        <option value="top10">Top10占比</option>
                        <option value="sourcePlatform">信源平台占比</option>
                        <option value="sourceArticle">信源文章占比</option>
                    </select>
                </div>
            </div>
            
            <div class="alert alert-info" id="keywordPlatformHint">
                ⚠️ 请在上方选择具体的AI平台查看关键词分析数据
            </div>
            
            <div class="card" id="keywordAnalysisCard" style="display: none;">
                <h2 class="card-title">🔍 关键词维度分析</h2>
                
                <div style="overflow-x: auto; margin-top: 16px;">
                    <table id="keywordAnalysisTable">
                        <thead>
                            <tr id="keywordAnalysisHeader">
                                <th style="min-width: 200px;">关键词</th>
                                <th>排名1</th>
                                <th>排名2</th>
                                <th>排名3</th>
                                <th>排名4</th>
                                <th>排名5</th>
                            </tr>
                        </thead>
                        <tbody id="keywordAnalysisBody">
                            <tr><td colspan="6">请选择AI平台</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 本地脚本 -->
    <script src="script.js"></script>
</body>
</html>
